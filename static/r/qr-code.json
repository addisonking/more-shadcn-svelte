{
	"$schema": "https://shadcn-svelte.com/schema/registry-item.json",
	"name": "qr-code",
	"title": "QR Code",
	"type": "registry:ui",
	"description": "A vector-based QR generator with support for colors and logos.",
	"dependencies": [
		"qrcode-generator@^2.0.4"
	],
	"devDependencies": [
		"@types/qrcode-generator@^0.0.16"
	],
	"files": [
		{
			"content": "<script lang=\"ts\">\r\n    import { cn } from '$UTILS$';\r\n    import qrcode from 'qrcode-generator';\r\n    import type { Snippet } from 'svelte';\r\n\r\n    let {\r\n        value,\r\n        size = 128,\r\n        color = '#000000',\r\n        backgroundColor = '#FFFFFF',\r\n        errorCorrection = 'M', // 'L', 'M', 'Q', 'H'\r\n        margin = 2, // Modules of padding\r\n        class: className,\r\n        logo,\r\n        logoSize = 0.2 // Percentage of the QR code (0.2 = 20%)\r\n    }: {\r\n        value: string;\r\n        size?: number;\r\n        color?: string;\r\n        backgroundColor?: string;\r\n        errorCorrection?: 'L' | 'M' | 'Q' | 'H';\r\n        margin?: number;\r\n        class?: string;\r\n        logo?: string | Snippet;\r\n        logoSize?: number;\r\n    } = $props();\r\n\r\n    // Generate Matrix\r\n    let matrix = $derived.by(() => {\r\n        if (!value) return [];\r\n        try {\r\n            // Type 0 = Auto detect best version\r\n            const qr = qrcode(0, errorCorrection);\r\n            qr.addData(value);\r\n            qr.make();\r\n\r\n            const count = qr.getModuleCount();\r\n            // Convert to boolean[][] for easy rendering\r\n            const rows = [];\r\n            for (let r = 0; r < count; r++) {\r\n                const row = [];\r\n                for (let c = 0; c < count; c++) {\r\n                    row.push(qr.isDark(r, c));\r\n                }\r\n                rows.push(row);\r\n            }\r\n            return rows;\r\n        } catch (e) {\r\n            console.error(\"QR Generation failed\", e);\r\n            return [];\r\n        }\r\n    });\r\n\r\n    let moduleCount = $derived(matrix.length);\r\n    // Coordinate space size (modules + margin)\r\n    let viewBoxSize = $derived(moduleCount + margin * 2);\r\n</script>\r\n\r\n<div\r\n        class={cn(\"relative inline-flex items-center justify-center shrink-0\", className)}\r\n        style:width={`${size}px`}\r\n        style:height={`${size}px`}\r\n>\r\n    <svg\r\n            viewBox={`0 0 ${viewBoxSize} ${viewBoxSize}`}\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            shape-rendering=\"crispEdges\"\r\n            class=\"h-full w-full\"\r\n    >\r\n        <!-- Background -->\r\n        <rect width={viewBoxSize} height={viewBoxSize} fill={backgroundColor} />\r\n\r\n        <!-- Modules -->\r\n        {#each matrix as row, r}\r\n            {#each row as isDark, c}\r\n                {#if isDark}\r\n                    <!--\r\n                        Optimized: We render rects at coordinate (col + margin, row + margin).\r\n                        Each rect is 1x1 unit in the viewBox space.\r\n                     -->\r\n                    <rect\r\n                            x={c + margin}\r\n                            y={r + margin}\r\n                            width=\"1\"\r\n                            height=\"1\"\r\n                            fill={color}\r\n                    />\r\n                {/if}\r\n            {/each}\r\n        {/each}\r\n    </svg>\r\n\r\n    <!-- Logo Overlay -->\r\n    <!--\r\n        Note: We rely on Error Correction to handle the data obscured by the logo.\r\n        Ensure errorCorrection is set to 'H' (High) or 'Q' (Quartile) when using large logos.\r\n    -->\r\n    {#if logo}\r\n        <div\r\n                class=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center justify-center bg-background rounded-full p-1 shadow-sm\"\r\n                style:width={`${size * logoSize}px`}\r\n                style:height={`${size * logoSize}px`}\r\n        >\r\n            {#if typeof logo === 'string'}\r\n                <img src={logo} alt=\"QR Logo\" class=\"h-full w-full object-contain\" />\r\n            {:else}\r\n                {@render logo()}\r\n            {/if}\r\n        </div>\r\n    {/if}\r\n</div>",
			"type": "registry:ui",
			"target": "qr-code/qr-code.svelte"
		},
		{
			"content": "import QRCode from \"./qr-code.svelte\";\r\n\r\nexport { QRCode as Root };",
			"type": "registry:ui",
			"target": "qr-code/index.ts"
		}
	]
}